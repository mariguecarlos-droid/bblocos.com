;/*FB_PKG_DELIM*/

__d("KDSVideoSharedAudioStateManager.react",["FBLogger","react","react-compiler-runtime","useStable"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=e||(e=r("react")),d=u.use,m=u.useEffect,p=u.useRef,_=c.createContext();function f(e){var t=o("react-compiler-runtime").c(3),n=p(e),a;t[0]!==e?(a=function(){n.current=e},t[0]=e,t[1]=a):a=t[1],m(a,void 0);var i;return t[2]===Symbol.for("react.memo_cache_sentinel")?(i=function(){var e=new Set,t=!0,r=function(r,o){var t,a,i=(t=(a=n.current)==null?void 0:a.mutedSyncPolicy)!=null?t:"one_unmuted_makes_other_muted";e.forEach(function(e){e:switch(i){case"one_unmuted_makes_other_muted":{!o&&e!==r&&e.getRealtimeState().shouldBeMuted!==!0&&e.setMuted(!0,"audio_manager_initiated");break e}case"mute_unmute_in_sync":{e!==r&&e.getRealtimeState().shouldBeMuted!==o&&e.setMuted(o,"audio_manager_initiated");break e}case"always_muted":e!==r&&e.getRealtimeState().shouldBeMuted!==!0&&e.setMuted(!0,"audio_manager_initiated")}})};return{handleMutedChanged:r,registerPlayer:function(o){var r,a,i=(r=(a=n.current)==null?void 0:a.mutedSyncPolicy)!=null?r:"one_unmuted_makes_other_muted";if(i==="mute_unmute_in_sync"){var l,s=e.size?(l=e.values().next().value)==null?void 0:l.getRealtimeState().shouldBeMuted:t;s===!1&&o.setMuted(!1,"audio_manager_initiated")}else i==="always_muted"&&o.setMuted(!0,"audio_manager_initiated");return e.add(o),(function(){e.delete(o)})},setDefaultMuteState:function(n){t=n,r(null,n)}}},t[2]=i):i=t[2],r("useStable")(i)}function g(e){var t=o("react-compiler-runtime").c(3),n=e.children,r=e.configForNewStateManager,a=e.existingStateManager,i=f(r),l=a!=null?a:i,s;return t[0]!==n||t[1]!==l?(s=c.jsx(_.Provider,{value:l,children:n}),t[0]=n,t[1]=l,t[2]=s):s=t[2],s}function h(e,t){var n=o("react-compiler-runtime").c(4),a=d(_),i=t!=null?t:a;if(i==null)throw r("FBLogger")("abra").mustfixThrow("useKDSVideoSharedAudioState must be used within children of a KDSVideoSharedAudioStateManager, or be given a state manager argument");var l,s;n[0]!==i||n[1]!==e?(l=function(){if(!(e==null||i==null)){var t=null,n=e.subscribe(function(){var n=e.getRealtimeState().shouldBeMuted;n!==t&&(t=n,i.handleMutedChanged(e,n))}),r=i.registerPlayer(e);return(function(){n(),r()})}},s=[e,i],n[0]=i,n[1]=e,n[2]=l,n[3]=s):(l=n[2],s=n[3]),m(l,s)}l.KDSVideoSharedAudioStateManagerContext=_,l.useKDSVideoSharedAudioStateManagerDefinition=f,l.KDSVideoSharedAudioStateManagerProvider=g,l.useKDSVideoSharedAudioState=h}),98);
__d("KadabraSharedAudioStateWithDeviceAudioSettingsProvider.react.js",["KDSVideoSharedAudioStateManager.react","KadabraAudioContext","Promise","asyncToGeneratorRuntime","err","react","react-compiler-runtime"],(function(t,n,r,o,a,i,l){"use strict";var e,s,u=s||(s=o("react")),c=s.useEffect,d="KadabraDeviceSettings",m=1,p="audioSettings",_="startUnmuted";function f(){return new(e||(e=n("Promise")))(function(e,t){var n=window.indexedDB;n||t(r("err")("IndexedDB not supported"));var o=n.open(d,m);o.onerror=function(){t(r("err")("Failed to open IndexedDB database"))},o.onsuccess=function(){e(o.result)},o.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(p)||t.createObjectStore(p)}})}function g(){return h.apply(this,arguments)}function h(){return h=n("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{var t=yield f(),r=t.transaction([p],"readonly"),a=r.objectStore(p);return new(e||(e=n("Promise")))(function(e){var n=a.get(_);n.onsuccess=function(){t.close();var r=!1,a=n.result,i=a!=null&&typeof a=="object"&&a.value===!0;if(i===!0){var l=o("KadabraAudioContext").getAudioContext();l.state==="running"&&(r=!0),o("KadabraAudioContext").cleanupAudioContext()}e({startUnmuted:r})},n.onerror=function(){t.close(),e({startUnmuted:!1})}})}catch(e){return{startUnmuted:!1}}}),h.apply(this,arguments)}function y(e){f().then(function(t){var n=t.transaction([p],"readwrite"),r=n.objectStore(p);r.put({value:e.startUnmuted},_),t.close()}).catch(function(){})}function C(e){var t=o("react-compiler-runtime").c(6),n=e.children,r=e.configForStateManager,a=o("KDSVideoSharedAudioStateManager.react").useKDSVideoSharedAudioStateManagerDefinition(r),i,l;t[0]!==a?(i=function(){var e=a;return g().then(function(t){e&&t.startUnmuted&&e.setDefaultMuteState(!1)}).catch(b),(function(){e=null})},l=[a],t[0]=a,t[1]=i,t[2]=l):(i=t[1],l=t[2]),c(i,l);var s;return t[3]!==n||t[4]!==a?(s=u.jsx(o("KDSVideoSharedAudioStateManager.react").KDSVideoSharedAudioStateManagerContext.Provider,{value:a,children:n}),t[3]=n,t[4]=a,t[5]=s):s=t[5],s}function b(){}l.loadSettings=g,l.saveSettings=y,l.KadabraSharedAudioStateWithDeviceAudioSettingsProvider=C}),98);
__d("useOnRoutableDialogClose",["CometRouteRenderType","react","react-compiler-runtime","useCometRouterDispatcher"],(function(t,n,r,o,a,i,l){"use strict";var e,s=(e||(e=o("react"))).useCallback;function u(e,t){var n=o("react-compiler-runtime").c(8),a=e===void 0?"/":e,i;n[0]!==t?(i=t===void 0?{}:t,n[0]=t,n[1]=i):i=n[1];var l=i,s=o("CometRouteRenderType").useIsPushView(),u=r("useCometRouterDispatcher")(),c=o("CometRouteRenderType").useIsHosted(),d;return n[2]!==l||n[3]!==a||n[4]!==u||n[5]!==c||n[6]!==s?(d=function(){if(u)return s?u.popPushView():c?u.goBack():u.go(a,babelHelpers.extends({},l,{target:"self"}))},n[2]=l,n[3]=a,n[4]=u,n[5]=c,n[6]=s,n[7]=d):d=n[7],d}l.default=u}),98);